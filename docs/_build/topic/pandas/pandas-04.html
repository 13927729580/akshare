

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5. Pandas 数据结构 &mdash; AkShare 1.0.0 文档</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="6. 时间序列与日期用法" href="pandas-05.html" />
    <link rel="prev" title="4. Pandas 10大新功能" href="pandas-03.html" />
    <meta name="referrer" content="no-referrer"/>
     

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> AkShare
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">AkShare 概览</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">AkShare 安装指导</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributor.html">AkShare 贡献源码</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../answer.html">AkShare 答疑专栏</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">AkShare 快速入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/index.html">AkShare 数据字典</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../anaconda.html">AkShare 环境配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../special.html">AkShare 特别说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../strategy.html">AkShare 量化策略</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platform.html">AkShare 量化平台</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">AkShare 专题教程</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../anaconda/index.html">Anaconda 教程</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Pandas 教程</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pandas-00.html">1. Pandas 概览</a></li>
<li class="toctree-l3"><a class="reference internal" href="pandas-01.html">2. Pandas 基础用法</a></li>
<li class="toctree-l3"><a class="reference internal" href="pandas-02.html">3. Pandas 25 式</a></li>
<li class="toctree-l3"><a class="reference internal" href="pandas-03.html">4. Pandas 10大新功能</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">5. Pandas 数据结构</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#series">5.1. Series</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe">5.2. DataFrame</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pandas-05.html">6. 时间序列与日期用法</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../demo.html">AkShare 策略示例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">AkShare 版本更新</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">AkShare</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">AkShare 专题教程</a> &raquo;</li>
        
          <li><a href="index.html">Pandas 教程</a> &raquo;</li>
        
      <li><span class="section-number">5. </span>Pandas 数据结构</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/topic/pandas/pandas-04.md.txt" rel="nofollow"> 查看页面源码</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pandas">
<h1><span class="section-number">5. </span>Pandas 数据结构<a class="headerlink" href="#pandas" title="永久链接至标题">¶</a></h1>
<p>本节介绍 Pandas 基础数据结构，包括各类对象的数据类型、索引、轴标记、对齐等基础操作。首先，导入 NumPy 和 Pandas：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
<p>“<strong>数据对齐是内在的</strong>”，这一原则是根本。除非显式指定，Pandas 不会断开标签和数据之间的连接。</p>
<p>下文先简单介绍数据结构，然后再分门别类介绍每种功能与方法。</p>
<div class="section" id="series">
<h2><span class="section-number">5.1. </span>Series<a class="headerlink" href="#series" title="永久链接至标题">¶</a></h2>
<p><a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.Series.html#Pandas.Series"><code class="docutils literal notranslate"><span class="pre">Series</span></code></a> 是带标签的一维数组，可存储整数、浮点数、字符串、Python 对象等类型的数据。轴标签统称为<strong>索引</strong>。调用 <code class="docutils literal notranslate"><span class="pre">pd.Series</span></code> 函数即可创建 Series：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
<p>上述代码中，<code class="docutils literal notranslate"><span class="pre">data</span></code> 支持以下数据类型：</p>
<ul class="simple">
<li><p>Python 字典</p></li>
<li><p>多维数组</p></li>
<li><p>标量值（如，5）</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">index</span></code> 是轴标签列表。不同<strong>数据</strong>可分为以下几种情况：</p>
<p><strong>多维数组</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">data</span></code> 是多维数组时，<strong>index</strong> 长度必须与 <strong>data</strong> 长度一致。没有指定 <code class="docutils literal notranslate"><span class="pre">index</span></code> 参数时，创建数值型索引，即 <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">...,</span> <span class="pre">len(data)</span> <span class="pre">-</span> <span class="pre">1]</span></code>。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">s</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">0.469112</span>
<span class="n">b</span>   <span class="o">-</span><span class="mf">0.282863</span>
<span class="n">c</span>   <span class="o">-</span><span class="mf">1.509059</span>
<span class="n">d</span>   <span class="o">-</span><span class="mf">1.135632</span>
<span class="n">e</span>    <span class="mf">1.212112</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">s</span><span class="o">.</span><span class="n">index</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">Index</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> 
<span class="mi">0</span>   <span class="o">-</span><span class="mf">0.173215</span>
<span class="mi">1</span>    <span class="mf">0.119209</span>
<span class="mi">2</span>   <span class="o">-</span><span class="mf">1.044236</span>
<span class="mi">3</span>   <span class="o">-</span><span class="mf">0.861849</span>
<span class="mi">4</span>   <span class="o">-</span><span class="mf">2.104569</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>::: tip 注意</p>
<p>Pandas 的索引值可以重复。不支持重复索引值的操作会触发异常。其原因主要与性能有关，有很多计算实例，比如 GroupBy 操作就不用索引。</p>
<p>:::</p>
<p><strong>字典</strong></p>
<p>Series 可以用字典实例化：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span> 
<span class="n">b</span>    <span class="mi">1</span>
<span class="n">a</span>    <span class="mi">0</span>
<span class="n">c</span>    <span class="mi">2</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>::: tip 注意</p>
<p><code class="docutils literal notranslate"><span class="pre">data</span></code> 为字典，且未设置 <code class="docutils literal notranslate"><span class="pre">index</span></code> 参数时，如果 Python 版本 &gt;= 3.6 且 Pandas 版本 &gt;= 0.23，<code class="docutils literal notranslate"><span class="pre">Series</span></code> 按字典的插入顺序排序索引。</p>
<p>Python &lt; 3.6 或 Pandas &lt; 0.23，且未设置 <code class="docutils literal notranslate"><span class="pre">index</span></code> 参数时，<code class="docutils literal notranslate"><span class="pre">Series</span></code> 按字母顺序排序字典的键（key）列表。</p>
<p>:::</p>
<p>上例中，如果 Python &lt; 3.6 或 Pandas &lt; 0.23，<code class="docutils literal notranslate"><span class="pre">Series</span></code> 按字母排序字典的键。输出结果不是 <code class="docutils literal notranslate"> <span class="pre">['b',</span> <span class="pre">'a',</span> <span class="pre">'c']</span></code>，而是 <code class="docutils literal notranslate"><span class="pre">['a',</span> <span class="pre">'b',</span> <span class="pre">'c']</span></code>。</p>
<p>如果设置了 <code class="docutils literal notranslate"><span class="pre">index</span></code> 参数，则按索引标签提取 <code class="docutils literal notranslate"><span class="pre">data</span></code> 里对应的值。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">2.</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">0.0</span>
<span class="n">b</span>    <span class="mf">1.0</span>
<span class="n">c</span>    <span class="mf">2.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> 
<span class="n">b</span>    <span class="mf">1.0</span>
<span class="n">c</span>    <span class="mf">2.0</span>
<span class="n">d</span>    <span class="n">NaN</span>
<span class="n">a</span>    <span class="mf">0.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>::: tip 注意</p>
<p>Pandas 用 <code class="docutils literal notranslate"><span class="pre">NaN</span></code>（Not a Number）表示<strong>缺失数据</strong>。</p>
<p>:::</p>
<p><strong>标量值</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">data</span></code> 是标量值时，必须提供索引。<code class="docutils literal notranslate"><span class="pre">Series</span></code> 按<strong>索引</strong>长度重复该标量值。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mf">5.</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">5.0</span>
<span class="n">b</span>    <span class="mf">5.0</span>
<span class="n">c</span>    <span class="mf">5.0</span>
<span class="n">d</span>    <span class="mf">5.0</span>
<span class="n">e</span>    <span class="mf">5.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="section" id="id1">
<h3>Series 类似多维数组<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Series</span></code> 操作与 <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> 类似，支持大多数 NumPy 函数，还支持索引切片。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="mf">0.4691122999071863</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">s</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">0.469112</span>
<span class="n">b</span>   <span class="o">-</span><span class="mf">0.282863</span>
<span class="n">c</span>   <span class="o">-</span><span class="mf">1.509059</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">s</span><span class="p">[</span><span class="n">s</span> <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">median</span><span class="p">()]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">0.469112</span>
<span class="n">e</span>    <span class="mf">1.212112</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">s</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> 
<span class="n">e</span>    <span class="mf">1.212112</span>
<span class="n">d</span>   <span class="o">-</span><span class="mf">1.135632</span>
<span class="n">b</span>   <span class="o">-</span><span class="mf">0.282863</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">1.598575</span>
<span class="n">b</span>    <span class="mf">0.753623</span>
<span class="n">c</span>    <span class="mf">0.221118</span>
<span class="n">d</span>    <span class="mf">0.321219</span>
<span class="n">e</span>    <span class="mf">3.360575</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>::: tip 注意</p>
<p><a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/user_guide/indexing.html#indexing">索引与选择数据</a>一节介绍了 <code class="docutils literal notranslate"><span class="pre">s[[4,</span> <span class="pre">3,</span> <span class="pre">1]]</span></code> 等数组索引操作。</p>
<p>:::</p>
<p>和 NumPy 数组一样，Series 也支持 <a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.Series.dtype.html#Pandas.Series.dtype"><code class="docutils literal notranslate"><span class="pre">dtype</span></code></a>。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">s</span><span class="o">.</span><span class="n">dtype</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Series</span></code> 的数据类型一般是 NumPy 数据类型。不过，Pandas 和第三方库在一些方面扩展了 NumPy 类型系统，即<a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.api.extensions.ExtensionDtype.html#Pandas.api.extensions.ExtensionDtype"><code class="docutils literal notranslate"><span class="pre">扩展数据类型</span></code></a>。比如，Pandas 的<a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/user_guide/categorical.html#categorical">类别型数据</a>与<a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/user_guide/integer_na.html#integer-na">可空整数数据类型</a>。更多信息，请参阅<a class="reference external" href="basics.html#basics-dtypes">数据类型</a> 。</p>
<p><a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.Series.array.html#Pandas.Series.array"><code class="docutils literal notranslate"><span class="pre">Series.array</span></code></a> 用于提取 <code class="docutils literal notranslate"><span class="pre">Series</span></code> 数组。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">s</span><span class="o">.</span><span class="n">array</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">19</span><span class="p">]:</span> 
<span class="o">&lt;</span><span class="n">PandasArray</span><span class="o">&gt;</span>
<span class="p">[</span> <span class="mf">0.4691122999071863</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2828633443286633</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5090585031735124</span><span class="p">,</span>
 <span class="o">-</span><span class="mf">1.1356323710171934</span><span class="p">,</span>  <span class="mf">1.2121120250208506</span><span class="p">]</span>
<span class="n">Length</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>执行不用索引的操作时，如禁用<a class="reference external" href="#dsintro-alignment">自动对齐</a>，访问数组非常有用。</p>
<p><a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.Series.array.html#Pandas.Series.array"><code class="docutils literal notranslate"><span class="pre">Series.array</span></code></a> 一般是<a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.api.extensions.ExtensionArray.html#Pandas.api.extensions.ExtensionArray"><code class="docutils literal notranslate"><span class="pre">扩展数组</span></code></a>。简单说，扩展数组是把 N 个 <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> 包在一起的打包器。Pandas 知道怎么把<code class="docutils literal notranslate"><span class="pre">扩展数组</span></code>存储到 <code class="docutils literal notranslate"><span class="pre">Series</span></code> 或 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 的列里。更多信息，请参阅<a class="reference external" href="basics.html#basics-dtypes">数据类型</a>。</p>
<p>Series 只是类似于多维数组，提取<strong>真正</strong>的多维数组，要用
<a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.Series.to_numpy.html#Pandas.Series.to_numpy"><code class="docutils literal notranslate"><span class="pre">Series.to_numpy()</span></code></a>。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="n">s</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">0.4691</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2829</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5091</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1356</span><span class="p">,</span>  <span class="mf">1.2121</span><span class="p">])</span>
</pre></div>
</div>
<p>Series 是<a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.api.extensions.ExtensionArray.html#Pandas.api.extensions.ExtensionArray"><code class="docutils literal notranslate"><span class="pre">扩展数组</span></code></a> ，<a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.Series.to_numpy.html#Pandas.Series.to_numpy"><code class="docutils literal notranslate"><span class="pre">Series.to_numpy()</span></code></a> 返回的是 NumPy 多维数组。</p>
</div>
<div class="section" id="id2">
<h3>Series 类似字典<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h3>
<p>Series 类似固定大小的字典，可以用索引标签提取值或设置值：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="mf">0.4691122999071863</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">12.</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="n">s</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">23</span><span class="p">]:</span> 
<span class="n">a</span>     <span class="mf">0.469112</span>
<span class="n">b</span>    <span class="o">-</span><span class="mf">0.282863</span>
<span class="n">c</span>    <span class="o">-</span><span class="mf">1.509059</span>
<span class="n">d</span>    <span class="o">-</span><span class="mf">1.135632</span>
<span class="n">e</span>    <span class="mf">12.000000</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">24</span><span class="p">]:</span> <span class="s1">&#39;e&#39;</span> <span class="ow">in</span> <span class="n">s</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">24</span><span class="p">]:</span> <span class="kc">True</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">25</span><span class="p">]:</span> <span class="s1">&#39;f&#39;</span> <span class="ow">in</span> <span class="n">s</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">25</span><span class="p">]:</span> <span class="kc">False</span>
</pre></div>
</div>
<p>引用 <code class="docutils literal notranslate"><span class="pre">Series</span></code> 里没有的标签会触发异常：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span>
<span class="go">KeyError: &#39;f&#39;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">get</span></code> 方法可以提取 <code class="docutils literal notranslate"><span class="pre">Series</span></code> 里没有的标签，返回 <code class="docutils literal notranslate"><span class="pre">None</span></code> 或指定默认值：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">26</span><span class="p">]:</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">27</span><span class="p">]:</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">27</span><span class="p">]:</span> <span class="n">nan</span>
</pre></div>
</div>
<p>更多信息，请参阅<a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/user_guide/indexing.html#indexing-attribute-access">属性访问</a>。</p>
</div>
<div class="section" id="id3">
<h3>矢量操作与对齐 Series 标签<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h3>
<p>Series 和 NumPy 数组一样，都不用循环每个值，而且 Series 支持大多数 NumPy 多维数组的方法。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">28</span><span class="p">]:</span> <span class="n">s</span> <span class="o">+</span> <span class="n">s</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">28</span><span class="p">]:</span> 
<span class="n">a</span>     <span class="mf">0.938225</span>
<span class="n">b</span>    <span class="o">-</span><span class="mf">0.565727</span>
<span class="n">c</span>    <span class="o">-</span><span class="mf">3.018117</span>
<span class="n">d</span>    <span class="o">-</span><span class="mf">2.271265</span>
<span class="n">e</span>    <span class="mf">24.000000</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">29</span><span class="p">]:</span> <span class="n">s</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">29</span><span class="p">]:</span> 
<span class="n">a</span>     <span class="mf">0.938225</span>
<span class="n">b</span>    <span class="o">-</span><span class="mf">0.565727</span>
<span class="n">c</span>    <span class="o">-</span><span class="mf">3.018117</span>
<span class="n">d</span>    <span class="o">-</span><span class="mf">2.271265</span>
<span class="n">e</span>    <span class="mf">24.000000</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">30</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">30</span><span class="p">]:</span> 
<span class="n">a</span>         <span class="mf">1.598575</span>
<span class="n">b</span>         <span class="mf">0.753623</span>
<span class="n">c</span>         <span class="mf">0.221118</span>
<span class="n">d</span>         <span class="mf">0.321219</span>
<span class="n">e</span>    <span class="mf">162754.791419</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>Series 和多维数组的主要区别在于， Series 之间的操作会自动基于标签对齐数据。因此，不用顾及执行计算操作的 Series 是否有相同的标签。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">31</span><span class="p">]:</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">31</span><span class="p">]:</span> 
<span class="n">a</span>         <span class="n">NaN</span>
<span class="n">b</span>   <span class="o">-</span><span class="mf">0.565727</span>
<span class="n">c</span>   <span class="o">-</span><span class="mf">3.018117</span>
<span class="n">d</span>   <span class="o">-</span><span class="mf">2.271265</span>
<span class="n">e</span>         <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>操作未对齐索引的 Series， 其计算结果是所有涉及索引的<strong>并集</strong>。如果在 Series 里找不到标签，运算结果标记为 <code class="docutils literal notranslate"><span class="pre">NaN</span></code>，即缺失值。编写无需显式对齐数据的代码，给交互数据分析和研究提供了巨大的自由度和灵活性。Pandas 数据结构集成的数据对齐功能，是 Pandas 区别于大多数标签型数据处理工具的重要特性。</p>
<p>::: tip 注意</p>
<p>总之，让不同索引对象操作的默认结果生成索引<strong>并集</strong>，是为了避免信息丢失。就算缺失了数据，索引标签依然包含计算的重要信息。当然，也可以用**<code class="docutils literal notranslate"><span class="pre">dropna</span></code>** 函数清除含有缺失值的标签。</p>
<p>:::</p>
</div>
<div class="section" id="id4">
<h3>名称属性<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<p>Series 支持 <code class="docutils literal notranslate"><span class="pre">name</span></code> 属性：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">32</span><span class="p">]:</span> <span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;something&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">33</span><span class="p">]:</span> <span class="n">s</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">33</span><span class="p">]:</span> 
<span class="mi">0</span>   <span class="o">-</span><span class="mf">0.494929</span>
<span class="mi">1</span>    <span class="mf">1.071804</span>
<span class="mi">2</span>    <span class="mf">0.721555</span>
<span class="mi">3</span>   <span class="o">-</span><span class="mf">0.706771</span>
<span class="mi">4</span>   <span class="o">-</span><span class="mf">1.039575</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">something</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">34</span><span class="p">]:</span> <span class="n">s</span><span class="o">.</span><span class="n">name</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">34</span><span class="p">]:</span> <span class="s1">&#39;something&#39;</span>
</pre></div>
</div>
<p>一般情况下，Series 自动分配 <code class="docutils literal notranslate"><span class="pre">name</span></code>，特别是提取一维 DataFrame 切片时，详见下文。</p>
<p><em>0.18.0 版新增。</em></p>
<p><a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.Series.rename.html#Pandas.Series.rename"><code class="docutils literal notranslate"><span class="pre">pandas.Series.rename()</span></code></a> 方法用于重命名 Series 。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">35</span><span class="p">]:</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;different&quot;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">36</span><span class="p">]:</span> <span class="n">s2</span><span class="o">.</span><span class="n">name</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">36</span><span class="p">]:</span> <span class="s1">&#39;different&#39;</span>
</pre></div>
</div>
<p>注意，<code class="docutils literal notranslate"><span class="pre">s</span></code> 与 <code class="docutils literal notranslate"><span class="pre">s2</span></code> 指向不同的对象。</p>
</div>
</div>
<div class="section" id="dataframe">
<h2><span class="section-number">5.2. </span>DataFrame<a class="headerlink" href="#dataframe" title="永久链接至标题">¶</a></h2>
<p><strong>DataFrame</strong> 是由多种类型的列构成的二维标签数据结构，类似于 Excel 、SQL 表，或 Series 对象构成的字典。DataFrame 是最常用的 Pandas 对象，与 Series 一样，DataFrame 支持多种类型的输入数据：</p>
<ul class="simple">
<li><p>一维 ndarray、列表、字典、Series 字典</p></li>
<li><p>二维 numpy.ndarray</p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/user/basics.rec.html">结构多维数组或记录多维数组</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Series</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></p></li>
</ul>
<p>除了数据，还可以有选择地传递 <strong>index</strong>（行标签）和 <strong>columns</strong>（列标签）参数。传递了索引或列，就可以确保生成的 DataFrame 里包含索引或列。Series 字典加上指定索引时，会丢弃与传递的索引不匹配的所有数据。</p>
<p>没有传递轴标签时，按常规依据输入数据进行构建。</p>
<p>::: tip 注意</p>
<p>Python &gt; = 3.6，且 Pandas &gt; = 0.23，数据是字典，且未指定 <code class="docutils literal notranslate"><span class="pre">columns</span></code> 参数时，<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 的列按字典的插入顺序排序。</p>
<p>Python &lt; 3.6 或 Pandas &lt; 0.23，且未指定 <code class="docutils literal notranslate"><span class="pre">columns</span></code> 参数时，<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 的列按字典键的字母排序。</p>
<p>:::</p>
<div class="section" id="series-dataframe">
<h3>用 Series 字典或字典生成 DataFrame<a class="headerlink" href="#series-dataframe" title="永久链接至标题">¶</a></h3>
<p>生成的<strong>索引</strong>是每个 <strong>Series</strong> 索引的并集。先把嵌套字典转换为 Series。如果没有指定列，DataFrame 的列就是字典键的有序列表。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">37</span><span class="p">]:</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]),</span>
   <span class="o">....</span><span class="p">:</span>      <span class="s1">&#39;two&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])}</span>
   <span class="o">....</span><span class="p">:</span> 

<span class="n">In</span> <span class="p">[</span><span class="mi">38</span><span class="p">]:</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">39</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">39</span><span class="p">]:</span> 
   <span class="n">one</span>  <span class="n">two</span>
<span class="n">a</span>  <span class="mf">1.0</span>  <span class="mf">1.0</span>
<span class="n">b</span>  <span class="mf">2.0</span>  <span class="mf">2.0</span>
<span class="n">c</span>  <span class="mf">3.0</span>  <span class="mf">3.0</span>
<span class="n">d</span>  <span class="n">NaN</span>  <span class="mf">4.0</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">40</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">40</span><span class="p">]:</span> 
   <span class="n">one</span>  <span class="n">two</span>
<span class="n">d</span>  <span class="n">NaN</span>  <span class="mf">4.0</span>
<span class="n">b</span>  <span class="mf">2.0</span>  <span class="mf">2.0</span>
<span class="n">a</span>  <span class="mf">1.0</span>  <span class="mf">1.0</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">41</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">41</span><span class="p">]:</span> 
   <span class="n">two</span> <span class="n">three</span>
<span class="n">d</span>  <span class="mf">4.0</span>   <span class="n">NaN</span>
<span class="n">b</span>  <span class="mf">2.0</span>   <span class="n">NaN</span>
<span class="n">a</span>  <span class="mf">1.0</span>   <span class="n">NaN</span>
</pre></div>
</div>
<p><strong>index</strong> 和 <strong>columns</strong> 属性分别用于访问行、列标签：</p>
<p>::: tip 注意</p>
<p>指定列与数据字典一起传递时，传递的列会覆盖字典的键。</p>
<p>:::</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">42</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">42</span><span class="p">]:</span> <span class="n">Index</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">43</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">43</span><span class="p">]:</span> <span class="n">Index</span><span class="p">([</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3>用多维数组字典、列表字典生成 DataFrame<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h3>
<p>多维数组的长度必须相同。如果传递了索引参数，<code class="docutils literal notranslate"><span class="pre">index</span></code> 的长度必须与数组一致。如果没有传递索引参数，生成的结果是 <code class="docutils literal notranslate"><span class="pre">range(n)</span></code>，<code class="docutils literal notranslate"><span class="pre">n</span></code> 为数组长度。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">44</span><span class="p">]:</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span>
   <span class="o">....</span><span class="p">:</span>      <span class="s1">&#39;two&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]}</span>
   <span class="o">....</span><span class="p">:</span> 

<span class="n">In</span> <span class="p">[</span><span class="mi">45</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">45</span><span class="p">]:</span> 
   <span class="n">one</span>  <span class="n">two</span>
<span class="mi">0</span>  <span class="mf">1.0</span>  <span class="mf">4.0</span>
<span class="mi">1</span>  <span class="mf">2.0</span>  <span class="mf">3.0</span>
<span class="mi">2</span>  <span class="mf">3.0</span>  <span class="mf">2.0</span>
<span class="mi">3</span>  <span class="mf">4.0</span>  <span class="mf">1.0</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">46</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">46</span><span class="p">]:</span> 
   <span class="n">one</span>  <span class="n">two</span>
<span class="n">a</span>  <span class="mf">1.0</span>  <span class="mf">4.0</span>
<span class="n">b</span>  <span class="mf">2.0</span>  <span class="mf">3.0</span>
<span class="n">c</span>  <span class="mf">3.0</span>  <span class="mf">2.0</span>
<span class="n">d</span>  <span class="mf">4.0</span>  <span class="mf">1.0</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h3>用结构多维数组或记录多维数组生成 DataFrame<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h3>
<p>本例与数组字典的操作方式相同。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">47</span><span class="p">]:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;a10&#39;</span><span class="p">)])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">48</span><span class="p">]:</span> <span class="n">data</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="s2">&quot;World&quot;</span><span class="p">)]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">49</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">49</span><span class="p">]:</span> 
   <span class="n">A</span>    <span class="n">B</span>         <span class="n">C</span>
<span class="mi">0</span>  <span class="mi">1</span>  <span class="mf">2.0</span>  <span class="sa">b</span><span class="s1">&#39;Hello&#39;</span>
<span class="mi">1</span>  <span class="mi">2</span>  <span class="mf">3.0</span>  <span class="sa">b</span><span class="s1">&#39;World&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">50</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">50</span><span class="p">]:</span> 
        <span class="n">A</span>    <span class="n">B</span>         <span class="n">C</span>
<span class="n">first</span>   <span class="mi">1</span>  <span class="mf">2.0</span>  <span class="sa">b</span><span class="s1">&#39;Hello&#39;</span>
<span class="n">second</span>  <span class="mi">2</span>  <span class="mf">3.0</span>  <span class="sa">b</span><span class="s1">&#39;World&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">51</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">51</span><span class="p">]:</span> 
          <span class="n">C</span>  <span class="n">A</span>    <span class="n">B</span>
<span class="mi">0</span>  <span class="sa">b</span><span class="s1">&#39;Hello&#39;</span>  <span class="mi">1</span>  <span class="mf">2.0</span>
<span class="mi">1</span>  <span class="sa">b</span><span class="s1">&#39;World&#39;</span>  <span class="mi">2</span>  <span class="mf">3.0</span>
</pre></div>
</div>
<p>::: tip 注意</p>
<p>DataFrame 的运作方式与 NumPy 二维数组不同。</p>
<p>:::</p>
</div>
<div class="section" id="id7">
<h3>用列表字典生成 DataFrame<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">52</span><span class="p">]:</span> <span class="n">data2</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">53</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">53</span><span class="p">]:</span> 
   <span class="n">a</span>   <span class="n">b</span>     <span class="n">c</span>
<span class="mi">0</span>  <span class="mi">1</span>   <span class="mi">2</span>   <span class="n">NaN</span>
<span class="mi">1</span>  <span class="mi">5</span>  <span class="mi">10</span>  <span class="mf">20.0</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">54</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">54</span><span class="p">]:</span> 
        <span class="n">a</span>   <span class="n">b</span>     <span class="n">c</span>
<span class="n">first</span>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="n">NaN</span>
<span class="n">second</span>  <span class="mi">5</span>  <span class="mi">10</span>  <span class="mf">20.0</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">55</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">55</span><span class="p">]:</span> 
   <span class="n">a</span>   <span class="n">b</span>
<span class="mi">0</span>  <span class="mi">1</span>   <span class="mi">2</span>
<span class="mi">1</span>  <span class="mi">5</span>  <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h3>用元组字典生成 DataFrame<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h3>
<p>元组字典可以自动创建多层索引 DataFrame。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">56</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">):</span> <span class="p">{(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="mi">2</span><span class="p">},</span>
   <span class="o">....</span><span class="p">:</span>               <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">):</span> <span class="p">{(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">):</span> <span class="mi">4</span><span class="p">},</span>
   <span class="o">....</span><span class="p">:</span>               <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">):</span> <span class="p">{(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">):</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="mi">6</span><span class="p">},</span>
   <span class="o">....</span><span class="p">:</span>               <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">):</span> <span class="p">{(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">):</span> <span class="mi">8</span><span class="p">},</span>
   <span class="o">....</span><span class="p">:</span>               <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">):</span> <span class="p">{(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span> <span class="mi">9</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">):</span> <span class="mi">10</span><span class="p">}})</span>
   <span class="o">....</span><span class="p">:</span> 
<span class="n">Out</span><span class="p">[</span><span class="mi">56</span><span class="p">]:</span> 
       <span class="n">a</span>              <span class="n">b</span>      
       <span class="n">b</span>    <span class="n">a</span>    <span class="n">c</span>    <span class="n">a</span>     <span class="n">b</span>
<span class="n">A</span> <span class="n">B</span>  <span class="mf">1.0</span>  <span class="mf">4.0</span>  <span class="mf">5.0</span>  <span class="mf">8.0</span>  <span class="mf">10.0</span>
  <span class="n">C</span>  <span class="mf">2.0</span>  <span class="mf">3.0</span>  <span class="mf">6.0</span>  <span class="mf">7.0</span>   <span class="n">NaN</span>
  <span class="n">D</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">NaN</span>   <span class="mf">9.0</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h3>用 Series 创建 DataFrame<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h3>
<p>生成的 DataFrame 继承了输入的 Series 的索引，如果没有指定列名，默认列名是输入 Series 的名称。</p>
<p><strong>缺失数据</strong></p>
<p>更多内容，详见<a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/user_guide/missing_data.html#missing-data">缺失数据</a> 。DataFrame 里的缺失值用 <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> 表示。DataFrame 构建器以 <code class="docutils literal notranslate"><span class="pre">numpy.MaskedArray</span></code> 为参数时 ，被屏蔽的条目为缺失数据。</p>
</div>
<div class="section" id="id10">
<h3>备选构建器<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h3>
<p><strong>DataFrame.from_dict</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame.from_dict</span></code> 接收字典组成的字典或数组序列字典，并生成 DataFrame。除了 <code class="docutils literal notranslate"><span class="pre">orient</span></code> 参数默认为 <code class="docutils literal notranslate"><span class="pre">columns</span></code>，本构建器的操作与 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 构建器类似。把 <code class="docutils literal notranslate"><span class="pre">orient</span></code> 参数设置为 <code class="docutils literal notranslate"><span class="pre">'index'</span></code>， 即可把字典的键作为行标签。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">57</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])]))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">57</span><span class="p">]:</span> 
   <span class="n">A</span>  <span class="n">B</span>
<span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">4</span>
<span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">5</span>
<span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">6</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">orient='index'</span></code> 时，键是行标签。本例还传递了列名：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">58</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])]),</span>
   <span class="o">....</span><span class="p">:</span>                        <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span>
   <span class="o">....</span><span class="p">:</span> 
<span class="n">Out</span><span class="p">[</span><span class="mi">58</span><span class="p">]:</span> 
   <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>
<span class="n">A</span>    <span class="mi">1</span>    <span class="mi">2</span>      <span class="mi">3</span>
<span class="n">B</span>    <span class="mi">4</span>    <span class="mi">5</span>      <span class="mi">6</span>
</pre></div>
</div>
<p><strong>DataFrame.from_records</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame.from_records</span></code> 构建器支持元组列表或结构数据类型（<code class="docutils literal notranslate"><span class="pre">dtype</span></code>）的多维数组。本构建器与 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 构建器类似，只不过生成的 DataFrame 索引是结构数据类型指定的字段。例如：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">59</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">59</span><span class="p">]:</span> 
<span class="n">array</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;Hello&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;World&#39;</span><span class="p">)],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;f4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;S10&#39;</span><span class="p">)])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">60</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">60</span><span class="p">]:</span> 
          <span class="n">A</span>    <span class="n">B</span>
<span class="n">C</span>               
<span class="sa">b</span><span class="s1">&#39;Hello&#39;</span>  <span class="mi">1</span>  <span class="mf">2.0</span>
<span class="sa">b</span><span class="s1">&#39;World&#39;</span>  <span class="mi">2</span>  <span class="mf">3.0</span>
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h3>提取、添加、删除列<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h3>
<p>DataFrame 就像带索引的 Series 字典，提取、设置、删除列的操作与字典类似：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">61</span><span class="p">]:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">61</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">1.0</span>
<span class="n">b</span>    <span class="mf">2.0</span>
<span class="n">c</span>    <span class="mf">3.0</span>
<span class="n">d</span>    <span class="n">NaN</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">one</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">62</span><span class="p">]:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;three&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;two&#39;</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">63</span><span class="p">]:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">64</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">64</span><span class="p">]:</span> 
   <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>   <span class="n">flag</span>
<span class="n">a</span>  <span class="mf">1.0</span>  <span class="mf">1.0</span>    <span class="mf">1.0</span>  <span class="kc">False</span>
<span class="n">b</span>  <span class="mf">2.0</span>  <span class="mf">2.0</span>    <span class="mf">4.0</span>  <span class="kc">False</span>
<span class="n">c</span>  <span class="mf">3.0</span>  <span class="mf">3.0</span>    <span class="mf">9.0</span>   <span class="kc">True</span>
<span class="n">d</span>  <span class="n">NaN</span>  <span class="mf">4.0</span>    <span class="n">NaN</span>  <span class="kc">False</span>
</pre></div>
</div>
<p>删除（del、pop）列的方式也与字典类似：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">65</span><span class="p">]:</span> <span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;two&#39;</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">66</span><span class="p">]:</span> <span class="n">three</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;three&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">67</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">67</span><span class="p">]:</span> 
   <span class="n">one</span>   <span class="n">flag</span>
<span class="n">a</span>  <span class="mf">1.0</span>  <span class="kc">False</span>
<span class="n">b</span>  <span class="mf">2.0</span>  <span class="kc">False</span>
<span class="n">c</span>  <span class="mf">3.0</span>   <span class="kc">True</span>
<span class="n">d</span>  <span class="n">NaN</span>  <span class="kc">False</span>
</pre></div>
</div>
<p>标量值以广播的方式填充列：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">68</span><span class="p">]:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">69</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">69</span><span class="p">]:</span> 
   <span class="n">one</span>   <span class="n">flag</span>  <span class="n">foo</span>
<span class="n">a</span>  <span class="mf">1.0</span>  <span class="kc">False</span>  <span class="n">bar</span>
<span class="n">b</span>  <span class="mf">2.0</span>  <span class="kc">False</span>  <span class="n">bar</span>
<span class="n">c</span>  <span class="mf">3.0</span>   <span class="kc">True</span>  <span class="n">bar</span>
<span class="n">d</span>  <span class="n">NaN</span>  <span class="kc">False</span>  <span class="n">bar</span>
</pre></div>
</div>
<p>插入与 DataFrame 索引不同的 Series 时，以 DataFrame 的索引为准：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">70</span><span class="p">]:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;one_trunc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">71</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">71</span><span class="p">]:</span> 
   <span class="n">one</span>   <span class="n">flag</span>  <span class="n">foo</span>  <span class="n">one_trunc</span>
<span class="n">a</span>  <span class="mf">1.0</span>  <span class="kc">False</span>  <span class="n">bar</span>        <span class="mf">1.0</span>
<span class="n">b</span>  <span class="mf">2.0</span>  <span class="kc">False</span>  <span class="n">bar</span>        <span class="mf">2.0</span>
<span class="n">c</span>  <span class="mf">3.0</span>   <span class="kc">True</span>  <span class="n">bar</span>        <span class="n">NaN</span>
<span class="n">d</span>  <span class="n">NaN</span>  <span class="kc">False</span>  <span class="n">bar</span>        <span class="n">NaN</span>
</pre></div>
</div>
<p>可以插入原生多维数组，但长度必须与 DataFrame 索引长度一致。</p>
<p>默认在 DataFrame 尾部插入列。<code class="docutils literal notranslate"><span class="pre">insert</span></code> 函数可以指定插入列的位置：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">72</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">73</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">73</span><span class="p">]:</span> 
   <span class="n">one</span>  <span class="n">bar</span>   <span class="n">flag</span>  <span class="n">foo</span>  <span class="n">one_trunc</span>
<span class="n">a</span>  <span class="mf">1.0</span>  <span class="mf">1.0</span>  <span class="kc">False</span>  <span class="n">bar</span>        <span class="mf">1.0</span>
<span class="n">b</span>  <span class="mf">2.0</span>  <span class="mf">2.0</span>  <span class="kc">False</span>  <span class="n">bar</span>        <span class="mf">2.0</span>
<span class="n">c</span>  <span class="mf">3.0</span>  <span class="mf">3.0</span>   <span class="kc">True</span>  <span class="n">bar</span>        <span class="n">NaN</span>
<span class="n">d</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="kc">False</span>  <span class="n">bar</span>        <span class="n">NaN</span>
</pre></div>
</div>
</div>
<div class="section" id="id12">
<h3>用方法链分配新列<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h3>
<p>受 <a class="reference external" href="https://dplyr.tidyverse.org/reference/mutate.html">dplyr</a> 的 <code class="docutils literal notranslate"><span class="pre">mutate</span></code> 启发，DataFrame 提供了 <a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.DataFrame.assign.html#Pandas.DataFrame.assign"><code class="docutils literal notranslate"><span class="pre">assign()</span></code></a> 方法，可以利用现有的列创建新列。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">74</span><span class="p">]:</span> <span class="n">iris</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/iris.data&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">75</span><span class="p">]:</span> <span class="n">iris</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">75</span><span class="p">]:</span> 
   <span class="n">SepalLength</span>  <span class="n">SepalWidth</span>  <span class="n">PetalLength</span>  <span class="n">PetalWidth</span>         <span class="n">Name</span>
<span class="mi">0</span>          <span class="mf">5.1</span>         <span class="mf">3.5</span>          <span class="mf">1.4</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>
<span class="mi">1</span>          <span class="mf">4.9</span>         <span class="mf">3.0</span>          <span class="mf">1.4</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>
<span class="mi">2</span>          <span class="mf">4.7</span>         <span class="mf">3.2</span>          <span class="mf">1.3</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>
<span class="mi">3</span>          <span class="mf">4.6</span>         <span class="mf">3.1</span>          <span class="mf">1.5</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>
<span class="mi">4</span>          <span class="mf">5.0</span>         <span class="mf">3.6</span>          <span class="mf">1.4</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">76</span><span class="p">]:</span> <span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">sepal_ratio</span><span class="o">=</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;SepalWidth&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">iris</span><span class="p">[</span><span class="s1">&#39;SepalLength&#39;</span><span class="p">])</span>
   <span class="o">....</span><span class="p">:</span>      <span class="o">.</span><span class="n">head</span><span class="p">())</span>
   <span class="o">....</span><span class="p">:</span> 
<span class="n">Out</span><span class="p">[</span><span class="mi">76</span><span class="p">]:</span> 
   <span class="n">SepalLength</span>  <span class="n">SepalWidth</span>  <span class="n">PetalLength</span>  <span class="n">PetalWidth</span>         <span class="n">Name</span>  <span class="n">sepal_ratio</span>
<span class="mi">0</span>          <span class="mf">5.1</span>         <span class="mf">3.5</span>          <span class="mf">1.4</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>     <span class="mf">0.686275</span>
<span class="mi">1</span>          <span class="mf">4.9</span>         <span class="mf">3.0</span>          <span class="mf">1.4</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>     <span class="mf">0.612245</span>
<span class="mi">2</span>          <span class="mf">4.7</span>         <span class="mf">3.2</span>          <span class="mf">1.3</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>     <span class="mf">0.680851</span>
<span class="mi">3</span>          <span class="mf">4.6</span>         <span class="mf">3.1</span>          <span class="mf">1.5</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>     <span class="mf">0.673913</span>
<span class="mi">4</span>          <span class="mf">5.0</span>         <span class="mf">3.6</span>          <span class="mf">1.4</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>     <span class="mf">0.720000</span>
</pre></div>
</div>
<p>上例中，插入了一个预计算的值。还可以传递带参数的函数，在 <code class="docutils literal notranslate"><span class="pre">assign</span></code> 的 DataFrame 上求值。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">77</span><span class="p">]:</span> <span class="n">iris</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">sepal_ratio</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;SepalWidth&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;SepalLength&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">77</span><span class="p">]:</span> 
   <span class="n">SepalLength</span>  <span class="n">SepalWidth</span>  <span class="n">PetalLength</span>  <span class="n">PetalWidth</span>         <span class="n">Name</span>  <span class="n">sepal_ratio</span>
<span class="mi">0</span>          <span class="mf">5.1</span>         <span class="mf">3.5</span>          <span class="mf">1.4</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>     <span class="mf">0.686275</span>
<span class="mi">1</span>          <span class="mf">4.9</span>         <span class="mf">3.0</span>          <span class="mf">1.4</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>     <span class="mf">0.612245</span>
<span class="mi">2</span>          <span class="mf">4.7</span>         <span class="mf">3.2</span>          <span class="mf">1.3</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>     <span class="mf">0.680851</span>
<span class="mi">3</span>          <span class="mf">4.6</span>         <span class="mf">3.1</span>          <span class="mf">1.5</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>     <span class="mf">0.673913</span>
<span class="mi">4</span>          <span class="mf">5.0</span>         <span class="mf">3.6</span>          <span class="mf">1.4</span>         <span class="mf">0.2</span>  <span class="n">Iris</span><span class="o">-</span><span class="n">setosa</span>     <span class="mf">0.720000</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">assign</span></code> 返回的<strong>都是</strong>数据副本，原 DataFrame 不变。</p>
<p>未引用 DataFrame 时，传递可调用的，不是实际要插入的值。这种方式常见于在操作链中调用 <code class="docutils literal notranslate"><span class="pre">assign</span></code> 的操作。例如，将 DataFrame 限制为花萼长度大于 5 的观察值，计算比例，再制图：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">78</span><span class="p">]:</span> <span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;SepalLength &gt; 5&#39;</span><span class="p">)</span>
   <span class="o">....</span><span class="p">:</span>      <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">SepalRatio</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">SepalWidth</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">SepalLength</span><span class="p">,</span>
   <span class="o">....</span><span class="p">:</span>              <span class="n">PetalRatio</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">PetalWidth</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">PetalLength</span><span class="p">)</span>
   <span class="o">....</span><span class="p">:</span>      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;SepalRatio&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;PetalRatio&#39;</span><span class="p">))</span>
   <span class="o">....</span><span class="p">:</span> 
<span class="n">Out</span><span class="p">[</span><span class="mi">78</span><span class="p">]:</span> <span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7f66075a7978</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><img alt="https://upload-images.jianshu.io/upload_images/3240514-ff75949572dc8134.png" src="https://upload-images.jianshu.io/upload_images/3240514-ff75949572dc8134.png" /></p>
<p>上例用 <code class="docutils literal notranslate"><span class="pre">assign</span></code> 把函数传递给 DataFrame， 并执行函数运算。这是要注意的是，该 DataFrame 是筛选了花萼长度大于 5 以后的数据。首先执行的是筛选操作，再计算比例。这个例子就是对没有事先<em>筛选</em> DataFrame 进行的引用。</p>
<p><code class="docutils literal notranslate"><span class="pre">assign</span></code> 函数签名就是 <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>。键是新字段的列名，值为是插入值（例如，<code class="docutils literal notranslate"><span class="pre">Series</span></code> 或 NumPy 数组），或把 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 当做调用参数的函数。返回结果是插入新值的 DataFrame 副本。</p>
<p><em>0.23.0 版新增。</em></p>
<p>从 3.6 版开始，Python 可以保存 <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> 顺序。这种操作允许<em>依赖赋值</em>，<code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> 后的表达式，可以引用同一个 <a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.DataFrame.assign.html#Pandas.DataFrame.assign"><code class="docutils literal notranslate"><span class="pre">assign()</span></code></a> 函数里之前创建的列 。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">79</span><span class="p">]:</span> <span class="n">dfa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
   <span class="o">....</span><span class="p">:</span>                     <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
   <span class="o">....</span><span class="p">:</span> 

<span class="n">In</span> <span class="p">[</span><span class="mi">80</span><span class="p">]:</span> <span class="n">dfa</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span>
   <span class="o">....</span><span class="p">:</span>            <span class="n">D</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
   <span class="o">....</span><span class="p">:</span> 
<span class="n">Out</span><span class="p">[</span><span class="mi">80</span><span class="p">]:</span> 
   <span class="n">A</span>  <span class="n">B</span>  <span class="n">C</span>   <span class="n">D</span>
<span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">4</span>  <span class="mi">5</span>   <span class="mi">6</span>
<span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">5</span>  <span class="mi">7</span>   <span class="mi">9</span>
<span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">6</span>  <span class="mi">9</span>  <span class="mi">12</span>
</pre></div>
</div>
<p>第二个表达式里，<code class="docutils literal notranslate"><span class="pre">x['C']</span></code> 引用刚创建的列，与 <code class="docutils literal notranslate"><span class="pre">dfa['A']</span> <span class="pre">+</span> <span class="pre">dfa['B']</span></code> 等效。</p>
<p>要兼容所有 Python 版本，可以把 <code class="docutils literal notranslate"><span class="pre">assign</span></code> 操作分为两部分。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">81</span><span class="p">]:</span> <span class="n">dependent</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">82</span><span class="p">]:</span> <span class="p">(</span><span class="n">dependent</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
   <span class="o">....</span><span class="p">:</span>           <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">B</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
   <span class="o">....</span><span class="p">:</span> 
<span class="n">Out</span><span class="p">[</span><span class="mi">82</span><span class="p">]:</span> 
   <span class="n">A</span>  <span class="n">B</span>
<span class="mi">0</span>  <span class="mi">2</span>  <span class="mi">4</span>
<span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">4</span>
<span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">4</span>
</pre></div>
</div>
<p>::: danger 警告</p>
<p>依赖赋值改变了 Python 3.6 及之后版本与 Python 3.6 之前版本的代码操作方式。</p>
<p>要想编写支持 3.6 之前或之后版本的 Python 代码，传递 <code class="docutils literal notranslate"><span class="pre">assign</span></code> 表达式时，要注意以下两点：</p>
<ul class="simple">
<li><p>更新现有的列</p></li>
<li><p>在同一个 <code class="docutils literal notranslate"><span class="pre">assign</span></code> 引用刚建立的更新列</p></li>
</ul>
<p>示例如下，更新列 “A”，然后，在创建 “B” 列时引用该列。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dependent</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dependent</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Python 3.5 或更早版本的表达式在创建 <code class="docutils literal notranslate"><span class="pre">B</span></code> 列时引用的是 <code class="docutils literal notranslate"><span class="pre">A</span></code> 列的“旧”值 <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">1]</span></code>。输出是：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span>  <span class="n">B</span>
<span class="mi">0</span>  <span class="mi">2</span>  <span class="mi">3</span>
<span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>
<span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">3</span>
</pre></div>
</div>
<p>Python &gt;= 3.6 的表达式创建 <code class="docutils literal notranslate"><span class="pre">A</span></code> 列时，引用的是 <code class="docutils literal notranslate"><span class="pre">A</span></code> 列的“”新”值，<code class="docutils literal notranslate"><span class="pre">[2,</span> <span class="pre">2,</span> <span class="pre">2]</span></code>，输出是：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span>  <span class="n">B</span>
<span class="mi">0</span>  <span class="mi">2</span>  <span class="mi">4</span>
<span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">4</span>
<span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">4</span>
</pre></div>
</div>
<p>:::</p>
</div>
<div class="section" id="id13">
<h3>索引 / 选择<a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h3>
<p>索引基础用法如下：</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>操作</th>
<th>句法</th>
<th>结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>选择列</td>
<td><code>df[col]</code></td>
<td>Series</td>
</tr>
<tr>
<td>用标签选择行</td>
<td><code>df.loc[label]</code></td>
<td>Series</td>
</tr>
<tr>
<td>用整数位置选择行</td>
<td><code>df.iloc[loc]</code></td>
<td>Series</td>
</tr>
<tr>
<td>行切片</td>
<td><code>df[5:10]</code></td>
<td>DataFrame</td>
</tr>
<tr>
<td>用布尔向量选择行</td>
<td><code>df[bool_vec]</code></td>
<td>DataFrame</td>
</tr>
</tbody>
</table><p>选择行返回 Series，索引是 DataFrame 的列：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">83</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">83</span><span class="p">]:</span> 
<span class="n">one</span>              <span class="mi">2</span>
<span class="n">bar</span>              <span class="mi">2</span>
<span class="n">flag</span>         <span class="kc">False</span>
<span class="n">foo</span>            <span class="n">bar</span>
<span class="n">one_trunc</span>        <span class="mi">2</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">84</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">84</span><span class="p">]:</span> 
<span class="n">one</span>             <span class="mi">3</span>
<span class="n">bar</span>             <span class="mi">3</span>
<span class="n">flag</span>         <span class="kc">True</span>
<span class="n">foo</span>           <span class="n">bar</span>
<span class="n">one_trunc</span>     <span class="n">NaN</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
<p>高级索引、切片技巧，请参阅<a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/user_guide/indexing.html#indexing">索引</a>。<a class="reference external" href="basics.html#basics-reindexing">重建索引</a>介绍重建索引 / 遵循新标签集的基础知识。</p>
</div>
<div class="section" id="id14">
<h3>数据对齐和运算<a class="headerlink" href="#id14" title="永久链接至标题">¶</a></h3>
<p>DataFrame 对象可以自动对齐**列与索引（行标签）**的数据。与上文一样，生成的结果是列和行标签的并集。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">85</span><span class="p">]:</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">86</span><span class="p">]:</span> <span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">87</span><span class="p">]:</span> <span class="n">df</span> <span class="o">+</span> <span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">87</span><span class="p">]:</span> 
          <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>   <span class="n">D</span>
<span class="mi">0</span>  <span class="mf">0.045691</span> <span class="o">-</span><span class="mf">0.014138</span>  <span class="mf">1.380871</span> <span class="n">NaN</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">0.955398</span> <span class="o">-</span><span class="mf">1.501007</span>  <span class="mf">0.037181</span> <span class="n">NaN</span>
<span class="mi">2</span> <span class="o">-</span><span class="mf">0.662690</span>  <span class="mf">1.534833</span> <span class="o">-</span><span class="mf">0.859691</span> <span class="n">NaN</span>
<span class="mi">3</span> <span class="o">-</span><span class="mf">2.452949</span>  <span class="mf">1.237274</span> <span class="o">-</span><span class="mf">0.133712</span> <span class="n">NaN</span>
<span class="mi">4</span>  <span class="mf">1.414490</span>  <span class="mf">1.951676</span> <span class="o">-</span><span class="mf">2.320422</span> <span class="n">NaN</span>
<span class="mi">5</span> <span class="o">-</span><span class="mf">0.494922</span> <span class="o">-</span><span class="mf">1.649727</span> <span class="o">-</span><span class="mf">1.084601</span> <span class="n">NaN</span>
<span class="mi">6</span> <span class="o">-</span><span class="mf">1.047551</span> <span class="o">-</span><span class="mf">0.748572</span> <span class="o">-</span><span class="mf">0.805479</span> <span class="n">NaN</span>
<span class="mi">7</span>       <span class="n">NaN</span>       <span class="n">NaN</span>       <span class="n">NaN</span> <span class="n">NaN</span>
<span class="mi">8</span>       <span class="n">NaN</span>       <span class="n">NaN</span>       <span class="n">NaN</span> <span class="n">NaN</span>
<span class="mi">9</span>       <span class="n">NaN</span>       <span class="n">NaN</span>       <span class="n">NaN</span> <span class="n">NaN</span>
</pre></div>
</div>
<p>DataFrame 和 Series 之间执行操作时，默认操作是在 DataFrame 的<strong>列</strong>上对齐 Series 的<strong>索引</strong>，按行执行<a class="reference external" href="http://docs.scipy.org/doc/numpy/user/basics.broadcasting.html">广播</a>操作。例如：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">88</span><span class="p">]:</span> <span class="n">df</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">88</span><span class="p">]:</span> 
          <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>         <span class="n">D</span>
<span class="mi">0</span>  <span class="mf">0.000000</span>  <span class="mf">0.000000</span>  <span class="mf">0.000000</span>  <span class="mf">0.000000</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">1.359261</span> <span class="o">-</span><span class="mf">0.248717</span> <span class="o">-</span><span class="mf">0.453372</span> <span class="o">-</span><span class="mf">1.754659</span>
<span class="mi">2</span>  <span class="mf">0.253128</span>  <span class="mf">0.829678</span>  <span class="mf">0.010026</span> <span class="o">-</span><span class="mf">1.991234</span>
<span class="mi">3</span> <span class="o">-</span><span class="mf">1.311128</span>  <span class="mf">0.054325</span> <span class="o">-</span><span class="mf">1.724913</span> <span class="o">-</span><span class="mf">1.620544</span>
<span class="mi">4</span>  <span class="mf">0.573025</span>  <span class="mf">1.500742</span> <span class="o">-</span><span class="mf">0.676070</span>  <span class="mf">1.367331</span>
<span class="mi">5</span> <span class="o">-</span><span class="mf">1.741248</span>  <span class="mf">0.781993</span> <span class="o">-</span><span class="mf">1.241620</span> <span class="o">-</span><span class="mf">2.053136</span>
<span class="mi">6</span> <span class="o">-</span><span class="mf">1.240774</span> <span class="o">-</span><span class="mf">0.869551</span> <span class="o">-</span><span class="mf">0.153282</span>  <span class="mf">0.000430</span>
<span class="mi">7</span> <span class="o">-</span><span class="mf">0.743894</span>  <span class="mf">0.411013</span> <span class="o">-</span><span class="mf">0.929563</span> <span class="o">-</span><span class="mf">0.282386</span>
<span class="mi">8</span> <span class="o">-</span><span class="mf">1.194921</span>  <span class="mf">1.320690</span>  <span class="mf">0.238224</span> <span class="o">-</span><span class="mf">1.482644</span>
<span class="mi">9</span>  <span class="mf">2.293786</span>  <span class="mf">1.856228</span>  <span class="mf">0.773289</span> <span class="o">-</span><span class="mf">1.446531</span>
</pre></div>
</div>
<p>时间序列是特例，DataFrame 索引包含日期时，按列广播：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">89</span><span class="p">]:</span> <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;1/1/2000&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">90</span><span class="p">]:</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">91</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">91</span><span class="p">]:</span> 
                   <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="o">-</span><span class="mf">1.226825</span>  <span class="mf">0.769804</span> <span class="o">-</span><span class="mf">1.281247</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span> <span class="o">-</span><span class="mf">0.727707</span> <span class="o">-</span><span class="mf">0.121306</span> <span class="o">-</span><span class="mf">0.097883</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span>  <span class="mf">0.695775</span>  <span class="mf">0.341734</span>  <span class="mf">0.959726</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span> <span class="o">-</span><span class="mf">1.110336</span> <span class="o">-</span><span class="mf">0.619976</span>  <span class="mf">0.149748</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span> <span class="o">-</span><span class="mf">0.732339</span>  <span class="mf">0.687738</span>  <span class="mf">0.176444</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span>  <span class="mf">0.403310</span> <span class="o">-</span><span class="mf">0.154951</span>  <span class="mf">0.301624</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">07</span> <span class="o">-</span><span class="mf">2.179861</span> <span class="o">-</span><span class="mf">1.369849</span> <span class="o">-</span><span class="mf">0.954208</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">08</span>  <span class="mf">1.462696</span> <span class="o">-</span><span class="mf">1.743161</span> <span class="o">-</span><span class="mf">0.826591</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">92</span><span class="p">]:</span> <span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">92</span><span class="p">]:</span> <span class="n">Pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">93</span><span class="p">]:</span> <span class="n">df</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">93</span><span class="p">]:</span> 
            <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>  <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>  <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>  <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>  <span class="o">...</span>  <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">08</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>   <span class="n">A</span>   <span class="n">B</span>   <span class="n">C</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>  <span class="o">...</span>                  <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>  <span class="o">...</span>                  <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>  <span class="o">...</span>                  <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>  <span class="o">...</span>                  <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>  <span class="o">...</span>                  <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>  <span class="o">...</span>                  <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">07</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>  <span class="o">...</span>                  <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">08</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>                  <span class="n">NaN</span>  <span class="o">...</span>                  <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span> <span class="n">NaN</span>

<span class="p">[</span><span class="mi">8</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">11</span> <span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
<p>::: danger 警告</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>已弃用，后期版本中会删除。实现此操作的首选方法是：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>:::</p>
<p>有关匹配和广播操作的显式控制，请参阅<a class="reference external" href="basics.html#basics-binop">二进制操作</a>。</p>
<p>标量操作与其它数据结构一样：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">94</span><span class="p">]:</span> <span class="n">df</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">94</span><span class="p">]:</span> 
                   <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="o">-</span><span class="mf">4.134126</span>  <span class="mf">5.849018</span> <span class="o">-</span><span class="mf">4.406237</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span> <span class="o">-</span><span class="mf">1.638535</span>  <span class="mf">1.393469</span>  <span class="mf">1.510587</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span>  <span class="mf">5.478873</span>  <span class="mf">3.708672</span>  <span class="mf">6.798628</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span> <span class="o">-</span><span class="mf">3.551681</span> <span class="o">-</span><span class="mf">1.099880</span>  <span class="mf">2.748742</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span> <span class="o">-</span><span class="mf">1.661697</span>  <span class="mf">5.438692</span>  <span class="mf">2.882222</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span>  <span class="mf">4.016548</span>  <span class="mf">1.225246</span>  <span class="mf">3.508122</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">07</span> <span class="o">-</span><span class="mf">8.899303</span> <span class="o">-</span><span class="mf">4.849247</span> <span class="o">-</span><span class="mf">2.771039</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">08</span>  <span class="mf">9.313480</span> <span class="o">-</span><span class="mf">6.715805</span> <span class="o">-</span><span class="mf">2.132955</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">95</span><span class="p">]:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">95</span><span class="p">]:</span> 
                   <span class="n">A</span>         <span class="n">B</span>          <span class="n">C</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="o">-</span><span class="mf">0.815112</span>  <span class="mf">1.299033</span>  <span class="o">-</span><span class="mf">0.780489</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span> <span class="o">-</span><span class="mf">1.374179</span> <span class="o">-</span><span class="mf">8.243600</span> <span class="o">-</span><span class="mf">10.216313</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span>  <span class="mf">1.437247</span>  <span class="mf">2.926250</span>   <span class="mf">1.041965</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span> <span class="o">-</span><span class="mf">0.900628</span> <span class="o">-</span><span class="mf">1.612966</span>   <span class="mf">6.677871</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span> <span class="o">-</span><span class="mf">1.365487</span>  <span class="mf">1.454041</span>   <span class="mf">5.667510</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span>  <span class="mf">2.479485</span> <span class="o">-</span><span class="mf">6.453662</span>   <span class="mf">3.315381</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">07</span> <span class="o">-</span><span class="mf">0.458745</span> <span class="o">-</span><span class="mf">0.730007</span>  <span class="o">-</span><span class="mf">1.047990</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">08</span>  <span class="mf">0.683669</span> <span class="o">-</span><span class="mf">0.573671</span>  <span class="o">-</span><span class="mf">1.209788</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">96</span><span class="p">]:</span> <span class="n">df</span> <span class="o">**</span> <span class="mi">4</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">96</span><span class="p">]:</span> 
                    <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>   <span class="mf">2.265327</span>  <span class="mf">0.351172</span>  <span class="mf">2.694833</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span>   <span class="mf">0.280431</span>  <span class="mf">0.000217</span>  <span class="mf">0.000092</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span>   <span class="mf">0.234355</span>  <span class="mf">0.013638</span>  <span class="mf">0.848376</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span>   <span class="mf">1.519910</span>  <span class="mf">0.147740</span>  <span class="mf">0.000503</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span>   <span class="mf">0.287640</span>  <span class="mf">0.223714</span>  <span class="mf">0.000969</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span>   <span class="mf">0.026458</span>  <span class="mf">0.000576</span>  <span class="mf">0.008277</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">07</span>  <span class="mf">22.579530</span>  <span class="mf">3.521204</span>  <span class="mf">0.829033</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">08</span>   <span class="mf">4.577374</span>  <span class="mf">9.233151</span>  <span class="mf">0.466834</span>
</pre></div>
</div>
<p>支持布尔运算符：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">97</span><span class="p">]:</span> <span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]},</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">98</span><span class="p">]:</span> <span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]},</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">99</span><span class="p">]:</span> <span class="n">df1</span> <span class="o">&amp;</span> <span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">99</span><span class="p">]:</span> 
       <span class="n">a</span>      <span class="n">b</span>
<span class="mi">0</span>  <span class="kc">False</span>  <span class="kc">False</span>
<span class="mi">1</span>  <span class="kc">False</span>   <span class="kc">True</span>
<span class="mi">2</span>   <span class="kc">True</span>  <span class="kc">False</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">100</span><span class="p">]:</span> <span class="n">df1</span> <span class="o">|</span> <span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">100</span><span class="p">]:</span> 
      <span class="n">a</span>     <span class="n">b</span>
<span class="mi">0</span>  <span class="kc">True</span>  <span class="kc">True</span>
<span class="mi">1</span>  <span class="kc">True</span>  <span class="kc">True</span>
<span class="mi">2</span>  <span class="kc">True</span>  <span class="kc">True</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">101</span><span class="p">]:</span> <span class="n">df1</span> <span class="o">^</span> <span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">101</span><span class="p">]:</span> 
       <span class="n">a</span>      <span class="n">b</span>
<span class="mi">0</span>   <span class="kc">True</span>   <span class="kc">True</span>
<span class="mi">1</span>   <span class="kc">True</span>  <span class="kc">False</span>
<span class="mi">2</span>  <span class="kc">False</span>   <span class="kc">True</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">102</span><span class="p">]:</span> <span class="o">-</span><span class="n">df1</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">102</span><span class="p">]:</span> 
       <span class="n">a</span>      <span class="n">b</span>
<span class="mi">0</span>  <span class="kc">False</span>   <span class="kc">True</span>
<span class="mi">1</span>   <span class="kc">True</span>  <span class="kc">False</span>
<span class="mi">2</span>  <span class="kc">False</span>  <span class="kc">False</span>
</pre></div>
</div>
</div>
<div class="section" id="id15">
<h3>转置<a class="headerlink" href="#id15" title="永久链接至标题">¶</a></h3>
<p>类似于多维数组，<code class="docutils literal notranslate"><span class="pre">T</span></code> 属性（即 <code class="docutils literal notranslate"><span class="pre">transpose</span></code> 函数）可以转置 DataFrame：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># only show the first 5 rows</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">103</span><span class="p">]:</span> <span class="n">df</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">103</span><span class="p">]:</span> 
   <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>  <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span>  <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span>  <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span>  <span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span>
<span class="n">A</span>   <span class="o">-</span><span class="mf">1.226825</span>   <span class="o">-</span><span class="mf">0.727707</span>    <span class="mf">0.695775</span>   <span class="o">-</span><span class="mf">1.110336</span>   <span class="o">-</span><span class="mf">0.732339</span>
<span class="n">B</span>    <span class="mf">0.769804</span>   <span class="o">-</span><span class="mf">0.121306</span>    <span class="mf">0.341734</span>   <span class="o">-</span><span class="mf">0.619976</span>    <span class="mf">0.687738</span>
<span class="n">C</span>   <span class="o">-</span><span class="mf">1.281247</span>   <span class="o">-</span><span class="mf">0.097883</span>    <span class="mf">0.959726</span>    <span class="mf">0.149748</span>    <span class="mf">0.176444</span>
</pre></div>
</div>
</div>
<div class="section" id="dataframe-numpy">
<h3>DataFrame 应用 NumPy 函数<a class="headerlink" href="#dataframe-numpy" title="永久链接至标题">¶</a></h3>
<p>Series 与 DataFrame 可使用 log、exp、sqrt 等多种元素级 NumPy 通用函数（ufunc） ，假设 DataFrame 的数据都是数字：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">104</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">104</span><span class="p">]:</span> 
                   <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>  <span class="mf">0.293222</span>  <span class="mf">2.159342</span>  <span class="mf">0.277691</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span>  <span class="mf">0.483015</span>  <span class="mf">0.885763</span>  <span class="mf">0.906755</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span>  <span class="mf">2.005262</span>  <span class="mf">1.407386</span>  <span class="mf">2.610980</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span>  <span class="mf">0.329448</span>  <span class="mf">0.537957</span>  <span class="mf">1.161542</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span>  <span class="mf">0.480783</span>  <span class="mf">1.989212</span>  <span class="mf">1.192968</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span>  <span class="mf">1.496770</span>  <span class="mf">0.856457</span>  <span class="mf">1.352053</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">07</span>  <span class="mf">0.113057</span>  <span class="mf">0.254145</span>  <span class="mf">0.385117</span>
<span class="mi">2000</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">08</span>  <span class="mf">4.317584</span>  <span class="mf">0.174966</span>  <span class="mf">0.437538</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">105</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">105</span><span class="p">]:</span> 
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.2268</span><span class="p">,</span>  <span class="mf">0.7698</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2812</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">0.7277</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1213</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0979</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.6958</span><span class="p">,</span>  <span class="mf">0.3417</span><span class="p">,</span>  <span class="mf">0.9597</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">1.1103</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.62</span>  <span class="p">,</span>  <span class="mf">0.1497</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">0.7323</span><span class="p">,</span>  <span class="mf">0.6877</span><span class="p">,</span>  <span class="mf">0.1764</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.4033</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.155</span> <span class="p">,</span>  <span class="mf">0.3016</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">2.1799</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3698</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9542</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.4627</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7432</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8266</span><span class="p">]])</span>
</pre></div>
</div>
<p>DataFrame 不是多维数组的替代品，它的索引语义和数据模型与多维数组都不同。</p>
<p><a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.Series.html#Pandas.Series"><code class="docutils literal notranslate"><span class="pre">Series</span></code></a> 应用 <code class="docutils literal notranslate"><span class="pre">__array_ufunc__</span></code>，支持 NumPy <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/ufuncs.html">通用函数</a>。</p>
<p>通用函数应用于 Series 的底层数组。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">106</span><span class="p">]:</span> <span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">107</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ser</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">107</span><span class="p">]:</span> 
<span class="mi">0</span>     <span class="mf">2.718282</span>
<span class="mi">1</span>     <span class="mf">7.389056</span>
<span class="mi">2</span>    <span class="mf">20.085537</span>
<span class="mi">3</span>    <span class="mf">54.598150</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p><em>0.25.0 版更改：</em> 多个 <code class="docutils literal notranslate"><span class="pre">Series</span></code> 传递给 <em>ufunc</em> 时，会先进行对齐。</p>
<p>Pandas 可以自动对齐 ufunc 里的多个带标签输入数据。例如，两个标签排序不同的 <a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.Series.html#Pandas.Series"><code class="docutils literal notranslate"><span class="pre">Series</span></code></a> 运算前，会先对齐标签。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">108</span><span class="p">]:</span> <span class="n">ser1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">109</span><span class="p">]:</span> <span class="n">ser2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">110</span><span class="p">]:</span> <span class="n">ser1</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">110</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mi">1</span>
<span class="n">b</span>    <span class="mi">2</span>
<span class="n">c</span>    <span class="mi">3</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">111</span><span class="p">]:</span> <span class="n">ser2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">111</span><span class="p">]:</span> 
<span class="n">b</span>    <span class="mi">1</span>
<span class="n">a</span>    <span class="mi">3</span>
<span class="n">c</span>    <span class="mi">5</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">112</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">ser1</span><span class="p">,</span> <span class="n">ser2</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">112</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mi">1</span>
<span class="n">b</span>    <span class="mi">0</span>
<span class="n">c</span>    <span class="mi">3</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>一般来说，Pandas 提取两个索引的并集，不重叠的值用缺失值填充。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">113</span><span class="p">]:</span> <span class="n">ser3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">114</span><span class="p">]:</span> <span class="n">ser3</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">114</span><span class="p">]:</span> 
<span class="n">b</span>    <span class="mi">2</span>
<span class="n">c</span>    <span class="mi">4</span>
<span class="n">d</span>    <span class="mi">6</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">115</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">ser1</span><span class="p">,</span> <span class="n">ser3</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">115</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="n">NaN</span>
<span class="n">b</span>    <span class="mf">0.0</span>
<span class="n">c</span>    <span class="mf">3.0</span>
<span class="n">d</span>    <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>对 <a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.Series.html#Pandas.Series"><code class="docutils literal notranslate"><span class="pre">Series</span></code></a> 和 <a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.Index.html#Pandas.Index"><code class="docutils literal notranslate"><span class="pre">Index</span></code></a> 应用二进制 ufunc 时，优先执行 Series，并返回的结果也是 Series 。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">116</span><span class="p">]:</span> <span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">117</span><span class="p">]:</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">118</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">ser</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">118</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mi">4</span>
<span class="mi">1</span>    <span class="mi">5</span>
<span class="mi">2</span>    <span class="mi">6</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>NumPy 通用函数可以安全地应用于非多维数组支持的 <a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.Series.html#Pandas.Series"><code class="docutils literal notranslate"><span class="pre">Series</span></code></a>，例如，<a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.SparseArray.html#Pandas.SparseArray"><code class="docutils literal notranslate"><span class="pre">SparseArray</span></code></a>（参见<a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/user_guide/sparse.html#sparse-calculation">稀疏计算</a>）。如有可能，应用 ufunc 而不把基础数据转换为多维数组。</p>
</div>
<div class="section" id="id16">
<h3>控制台显示<a class="headerlink" href="#id16" title="永久链接至标题">¶</a></h3>
<p>控制台显示大型 DataFrame 时，会根据空间调整显示大小。<a class="reference external" href="https://Pandas.pydata.org/Pandas-docs/stable/reference/api/Pandas.DataFrame.info.html#Pandas.DataFrame.info"><code class="docutils literal notranslate"><span class="pre">info()</span></code></a>函数可以查看 DataFrame 的信息摘要。下列代码读取 R 语言 <strong>plyr</strong> 包里的<strong>棒球</strong>数据集 CSV 文件）：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>In [119]: baseball = pd.read_csv(&#39;data/baseball.csv&#39;)

In [120]: print(baseball)
       id     player  year  stint team  lg   g   ab   r    h  X2b  X3b  hr   rbi   sb   cs  bb    so  ibb  hbp   sh   sf  gidp
0   88641  womacto01  2006      2  CHN  NL  19   50   6   14    1    0   1   2.0  1.0  1.0   4   4.0  0.0  0.0  3.0  0.0   0.0
1   88643  schilcu01  2006      1  BOS  AL  31    2   0    1    0    0   0   0.0  0.0  0.0   0   1.0  0.0  0.0  0.0  0.0   0.0
..    ...        ...   ...    ...  ...  ..  ..  ...  ..  ...  ...  ...  ..   ...  ...  ...  ..   ...  ...  ...  ...  ...   ...
98  89533   aloumo01  2007      1  NYN  NL  87  328  51  112   19    1  13  49.0  3.0  0.0  27  30.0  5.0  2.0  0.0  3.0  13.0
99  89534  alomasa02  2007      1  NYN  NL   8   22   1    3    1    0   0   0.0  0.0  0.0   0   3.0  0.0  0.0  0.0  0.0   0.0

[100 rows x 23 columns]

In [121]: baseball.info()
&lt;class &#39;Pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 100 entries, 0 to 99
Data columns (total 23 columns):
id        100 non-null int64
player    100 non-null object
year      100 non-null int64
stint     100 non-null int64
team      100 non-null object
lg        100 non-null object
g         100 non-null int64
ab        100 non-null int64
r         100 non-null int64
h         100 non-null int64
X2b       100 non-null int64
X3b       100 non-null int64
hr        100 non-null int64
rbi       100 non-null float64
sb        100 non-null float64
cs        100 non-null float64
bb        100 non-null int64
so        100 non-null float64
ibb       100 non-null float64
hbp       100 non-null float64
sh        100 non-null float64
sf        100 non-null float64
gidp      100 non-null float64
dtypes: float64(9), int64(11), object(3)
memory usage: 18.1+ KB
</pre></div>
</div>
<p>尽管 <code class="docutils literal notranslate"><span class="pre">to_string</span></code> 有时不匹配控制台的宽度，但还是可以用 <code class="docutils literal notranslate"><span class="pre">to_string</span></code> 以表格形式返回 DataFrame 的字符串表示形式：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">122</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="n">baseball</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">:,</span> <span class="p">:</span><span class="mi">12</span><span class="p">]</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span>
       <span class="nb">id</span>     <span class="n">player</span>  <span class="n">year</span>  <span class="n">stint</span> <span class="n">team</span>  <span class="n">lg</span>    <span class="n">g</span>   <span class="n">ab</span>   <span class="n">r</span>    <span class="n">h</span>  <span class="n">X2b</span>  <span class="n">X3b</span>
<span class="mi">80</span>  <span class="mi">89474</span>  <span class="n">finlest01</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">COL</span>  <span class="n">NL</span>   <span class="mi">43</span>   <span class="mi">94</span>   <span class="mi">9</span>   <span class="mi">17</span>    <span class="mi">3</span>    <span class="mi">0</span>
<span class="mi">81</span>  <span class="mi">89480</span>  <span class="n">embreal01</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">OAK</span>  <span class="n">AL</span>    <span class="mi">4</span>    <span class="mi">0</span>   <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>
<span class="mi">82</span>  <span class="mi">89481</span>  <span class="n">edmonji01</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">SLN</span>  <span class="n">NL</span>  <span class="mi">117</span>  <span class="mi">365</span>  <span class="mi">39</span>   <span class="mi">92</span>   <span class="mi">15</span>    <span class="mi">2</span>
<span class="mi">83</span>  <span class="mi">89482</span>  <span class="n">easleda01</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">NYN</span>  <span class="n">NL</span>   <span class="mi">76</span>  <span class="mi">193</span>  <span class="mi">24</span>   <span class="mi">54</span>    <span class="mi">6</span>    <span class="mi">0</span>
<span class="mi">84</span>  <span class="mi">89489</span>  <span class="n">delgaca01</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">NYN</span>  <span class="n">NL</span>  <span class="mi">139</span>  <span class="mi">538</span>  <span class="mi">71</span>  <span class="mi">139</span>   <span class="mi">30</span>    <span class="mi">0</span>
<span class="mi">85</span>  <span class="mi">89493</span>  <span class="n">cormirh01</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">CIN</span>  <span class="n">NL</span>    <span class="mi">6</span>    <span class="mi">0</span>   <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>
<span class="mi">86</span>  <span class="mi">89494</span>  <span class="n">coninje01</span>  <span class="mi">2007</span>      <span class="mi">2</span>  <span class="n">NYN</span>  <span class="n">NL</span>   <span class="mi">21</span>   <span class="mi">41</span>   <span class="mi">2</span>    <span class="mi">8</span>    <span class="mi">2</span>    <span class="mi">0</span>
<span class="mi">87</span>  <span class="mi">89495</span>  <span class="n">coninje01</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">CIN</span>  <span class="n">NL</span>   <span class="mi">80</span>  <span class="mi">215</span>  <span class="mi">23</span>   <span class="mi">57</span>   <span class="mi">11</span>    <span class="mi">1</span>
<span class="mi">88</span>  <span class="mi">89497</span>  <span class="n">clemero02</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">NYA</span>  <span class="n">AL</span>    <span class="mi">2</span>    <span class="mi">2</span>   <span class="mi">0</span>    <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">0</span>
<span class="mi">89</span>  <span class="mi">89498</span>  <span class="n">claytro01</span>  <span class="mi">2007</span>      <span class="mi">2</span>  <span class="n">BOS</span>  <span class="n">AL</span>    <span class="mi">8</span>    <span class="mi">6</span>   <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>
<span class="mi">90</span>  <span class="mi">89499</span>  <span class="n">claytro01</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">TOR</span>  <span class="n">AL</span>   <span class="mi">69</span>  <span class="mi">189</span>  <span class="mi">23</span>   <span class="mi">48</span>   <span class="mi">14</span>    <span class="mi">0</span>
<span class="mi">91</span>  <span class="mi">89501</span>  <span class="n">cirilje01</span>  <span class="mi">2007</span>      <span class="mi">2</span>  <span class="n">ARI</span>  <span class="n">NL</span>   <span class="mi">28</span>   <span class="mi">40</span>   <span class="mi">6</span>    <span class="mi">8</span>    <span class="mi">4</span>    <span class="mi">0</span>
<span class="mi">92</span>  <span class="mi">89502</span>  <span class="n">cirilje01</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">MIN</span>  <span class="n">AL</span>   <span class="mi">50</span>  <span class="mi">153</span>  <span class="mi">18</span>   <span class="mi">40</span>    <span class="mi">9</span>    <span class="mi">2</span>
<span class="mi">93</span>  <span class="mi">89521</span>  <span class="n">bondsba01</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">SFN</span>  <span class="n">NL</span>  <span class="mi">126</span>  <span class="mi">340</span>  <span class="mi">75</span>   <span class="mi">94</span>   <span class="mi">14</span>    <span class="mi">0</span>
<span class="mi">94</span>  <span class="mi">89523</span>  <span class="n">biggicr01</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">HOU</span>  <span class="n">NL</span>  <span class="mi">141</span>  <span class="mi">517</span>  <span class="mi">68</span>  <span class="mi">130</span>   <span class="mi">31</span>    <span class="mi">3</span>
<span class="mi">95</span>  <span class="mi">89525</span>  <span class="n">benitar01</span>  <span class="mi">2007</span>      <span class="mi">2</span>  <span class="n">FLO</span>  <span class="n">NL</span>   <span class="mi">34</span>    <span class="mi">0</span>   <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>
<span class="mi">96</span>  <span class="mi">89526</span>  <span class="n">benitar01</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">SFN</span>  <span class="n">NL</span>   <span class="mi">19</span>    <span class="mi">0</span>   <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>
<span class="mi">97</span>  <span class="mi">89530</span>  <span class="n">ausmubr01</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">HOU</span>  <span class="n">NL</span>  <span class="mi">117</span>  <span class="mi">349</span>  <span class="mi">38</span>   <span class="mi">82</span>   <span class="mi">16</span>    <span class="mi">3</span>
<span class="mi">98</span>  <span class="mi">89533</span>   <span class="n">aloumo01</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">NYN</span>  <span class="n">NL</span>   <span class="mi">87</span>  <span class="mi">328</span>  <span class="mi">51</span>  <span class="mi">112</span>   <span class="mi">19</span>    <span class="mi">1</span>
<span class="mi">99</span>  <span class="mi">89534</span>  <span class="n">alomasa02</span>  <span class="mi">2007</span>      <span class="mi">1</span>  <span class="n">NYN</span>  <span class="n">NL</span>    <span class="mi">8</span>   <span class="mi">22</span>   <span class="mi">1</span>    <span class="mi">3</span>    <span class="mi">1</span>    <span class="mi">0</span>
</pre></div>
</div>
<p>默认情况下，过宽的 DataFrame 会跨多行输出：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">123</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">123</span><span class="p">]:</span> 
          <span class="mi">0</span>         <span class="mi">1</span>         <span class="mi">2</span>         <span class="mi">3</span>         <span class="mi">4</span>         <span class="mi">5</span>         <span class="mi">6</span>         <span class="mi">7</span>         <span class="mi">8</span>         <span class="mi">9</span>        <span class="mi">10</span>        <span class="mi">11</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">0.345352</span>  <span class="mf">1.314232</span>  <span class="mf">0.690579</span>  <span class="mf">0.995761</span>  <span class="mf">2.396780</span>  <span class="mf">0.014871</span>  <span class="mf">3.357427</span> <span class="o">-</span><span class="mf">0.317441</span> <span class="o">-</span><span class="mf">1.236269</span>  <span class="mf">0.896171</span> <span class="o">-</span><span class="mf">0.487602</span> <span class="o">-</span><span class="mf">0.082240</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">2.182937</span>  <span class="mf">0.380396</span>  <span class="mf">0.084844</span>  <span class="mf">0.432390</span>  <span class="mf">1.519970</span> <span class="o">-</span><span class="mf">0.493662</span>  <span class="mf">0.600178</span>  <span class="mf">0.274230</span>  <span class="mf">0.132885</span> <span class="o">-</span><span class="mf">0.023688</span>  <span class="mf">2.410179</span>  <span class="mf">1.450520</span>
<span class="mi">2</span>  <span class="mf">0.206053</span> <span class="o">-</span><span class="mf">0.251905</span> <span class="o">-</span><span class="mf">2.213588</span>  <span class="mf">1.063327</span>  <span class="mf">1.266143</span>  <span class="mf">0.299368</span> <span class="o">-</span><span class="mf">0.863838</span>  <span class="mf">0.408204</span> <span class="o">-</span><span class="mf">1.048089</span> <span class="o">-</span><span class="mf">0.025747</span> <span class="o">-</span><span class="mf">0.988387</span>  <span class="mf">0.094055</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">display.width</span></code> 选项可以更改单行输出的宽度：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">124</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.width&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>  <span class="c1"># 默认值为 80</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">125</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">125</span><span class="p">]:</span> 
          <span class="mi">0</span>         <span class="mi">1</span>         <span class="mi">2</span>         <span class="mi">3</span>         <span class="mi">4</span>         <span class="mi">5</span>         <span class="mi">6</span>         <span class="mi">7</span>         <span class="mi">8</span>         <span class="mi">9</span>        <span class="mi">10</span>        <span class="mi">11</span>
<span class="mi">0</span>  <span class="mf">1.262731</span>  <span class="mf">1.289997</span>  <span class="mf">0.082423</span> <span class="o">-</span><span class="mf">0.055758</span>  <span class="mf">0.536580</span> <span class="o">-</span><span class="mf">0.489682</span>  <span class="mf">0.369374</span> <span class="o">-</span><span class="mf">0.034571</span> <span class="o">-</span><span class="mf">2.484478</span> <span class="o">-</span><span class="mf">0.281461</span>  <span class="mf">0.030711</span>  <span class="mf">0.109121</span>
<span class="mi">1</span>  <span class="mf">1.126203</span> <span class="o">-</span><span class="mf">0.977349</span>  <span class="mf">1.474071</span> <span class="o">-</span><span class="mf">0.064034</span> <span class="o">-</span><span class="mf">1.282782</span>  <span class="mf">0.781836</span> <span class="o">-</span><span class="mf">1.071357</span>  <span class="mf">0.441153</span>  <span class="mf">2.353925</span>  <span class="mf">0.583787</span>  <span class="mf">0.221471</span> <span class="o">-</span><span class="mf">0.744471</span>
<span class="mi">2</span>  <span class="mf">0.758527</span>  <span class="mf">1.729689</span> <span class="o">-</span><span class="mf">0.964980</span> <span class="o">-</span><span class="mf">0.845696</span> <span class="o">-</span><span class="mf">1.340896</span>  <span class="mf">1.846883</span> <span class="o">-</span><span class="mf">1.328865</span>  <span class="mf">1.682706</span> <span class="o">-</span><span class="mf">1.717693</span>  <span class="mf">0.888782</span>  <span class="mf">0.228440</span>  <span class="mf">0.901805</span>
</pre></div>
</div>
<p>还可以用 <code class="docutils literal notranslate"><span class="pre">display.max_colwidth</span></code> 调整最大列宽。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">126</span><span class="p">]:</span> <span class="n">datafile</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;filename_01&#39;</span><span class="p">,</span> <span class="s1">&#39;filename_02&#39;</span><span class="p">],</span>
   <span class="o">.....</span><span class="p">:</span>             <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;media/user_name/storage/folder_01/filename_01&quot;</span><span class="p">,</span>
   <span class="o">.....</span><span class="p">:</span>                      <span class="s2">&quot;media/user_name/storage/folder_02/filename_02&quot;</span><span class="p">]}</span>
   <span class="o">.....</span><span class="p">:</span> 

<span class="n">In</span> <span class="p">[</span><span class="mi">127</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">128</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">128</span><span class="p">]:</span> 
      <span class="n">filename</span>                           <span class="n">path</span>
<span class="mi">0</span>  <span class="n">filename_01</span>  <span class="n">media</span><span class="o">/</span><span class="n">user_name</span><span class="o">/</span><span class="n">storage</span><span class="o">/</span><span class="n">fo</span><span class="o">...</span>
<span class="mi">1</span>  <span class="n">filename_02</span>  <span class="n">media</span><span class="o">/</span><span class="n">user_name</span><span class="o">/</span><span class="n">storage</span><span class="o">/</span><span class="n">fo</span><span class="o">...</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">129</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">130</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">130</span><span class="p">]:</span> 
      <span class="n">filename</span>                                           <span class="n">path</span>
<span class="mi">0</span>  <span class="n">filename_01</span>  <span class="n">media</span><span class="o">/</span><span class="n">user_name</span><span class="o">/</span><span class="n">storage</span><span class="o">/</span><span class="n">folder_01</span><span class="o">/</span><span class="n">filename_01</span>
<span class="mi">1</span>  <span class="n">filename_02</span>  <span class="n">media</span><span class="o">/</span><span class="n">user_name</span><span class="o">/</span><span class="n">storage</span><span class="o">/</span><span class="n">folder_02</span><span class="o">/</span><span class="n">filename_02</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">expand_frame_repr</span></code> 选项可以禁用此功能，在一个区块里输出整个表格。</p>
</div>
<div class="section" id="dataframe-ipython">
<h3>DataFrame 列属性访问和 IPython 代码补全<a class="headerlink" href="#dataframe-ipython" title="永久链接至标题">¶</a></h3>
<p>DataFrame 列标签是有效的 Python 变量名时，可以像属性一样访问该列：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">131</span><span class="p">]:</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;foo1&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
   <span class="o">.....</span><span class="p">:</span>                    <span class="s1">&#39;foo2&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">)})</span>
   <span class="o">.....</span><span class="p">:</span> 

<span class="n">In</span> <span class="p">[</span><span class="mi">132</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">132</span><span class="p">]:</span> 
       <span class="n">foo1</span>      <span class="n">foo2</span>
<span class="mi">0</span>  <span class="mf">1.171216</span> <span class="o">-</span><span class="mf">0.858447</span>
<span class="mi">1</span>  <span class="mf">0.520260</span>  <span class="mf">0.306996</span>
<span class="mi">2</span> <span class="o">-</span><span class="mf">1.197071</span> <span class="o">-</span><span class="mf">0.028665</span>
<span class="mi">3</span> <span class="o">-</span><span class="mf">1.066969</span>  <span class="mf">0.384316</span>
<span class="mi">4</span> <span class="o">-</span><span class="mf">0.303421</span>  <span class="mf">1.574159</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">133</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">foo1</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">133</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mf">1.171216</span>
<span class="mi">1</span>    <span class="mf">0.520260</span>
<span class="mi">2</span>   <span class="o">-</span><span class="mf">1.197071</span>
<span class="mi">3</span>   <span class="o">-</span><span class="mf">1.066969</span>
<span class="mi">4</span>   <span class="o">-</span><span class="mf">0.303421</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">foo1</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p><a class="reference external" href="https://ipython.org">IPython</a> 支持补全功能，按 <strong>tab</strong> 键可以实现代码补全：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">134</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">fo</span><span class="o">&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>  <span class="c1"># 此时按 tab 键 会显示下列内容</span>
<span class="n">df</span><span class="o">.</span><span class="n">foo1</span>  <span class="n">df</span><span class="o">.</span><span class="n">foo2</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pandas-05.html" class="btn btn-neutral float-right" title="6. 时间序列与日期用法" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pandas-03.html" class="btn btn-neutral float-left" title="4. Pandas 10大新功能" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> 上一页</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; 版权所有 2019–2020, AkShare developers

    </p>
  </div>
    
    
    
    利用 <a href="http://sphinx-doc.org/">Sphinx</a> 构建，使用了 
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">主题</a>
    
    由 <a href="https://readthedocs.org">Read the Docs</a>开发. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 
<script type="text/javascript">
!function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
analytics.load("8UDQfnf3cyFSTsM4YANnW5sXmgZVILbA");
analytics.page();
}}();

analytics.ready(function () {
    ga('require', 'linker');
    ga('linker:autoLink', ['scrapinghub.com', 'crawlera.com']);
});
</script>


</body>
</html>